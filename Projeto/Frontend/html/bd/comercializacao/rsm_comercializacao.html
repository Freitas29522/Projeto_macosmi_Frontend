<!DOCTYPE html>
<html lang="pt">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=5.0"
    />
    <title>RSM Comercializacao Total</title>

    <!-- jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <!-- DevExpress -->
    <link
      rel="stylesheet"
      href="https://cdn3.devexpress.com/jslib/24.2.6/css/dx.material.blue.light.css"
    />
    <script src="https://cdn3.devexpress.com/jslib/24.2.6/js/dx.all.js"></script>

    <script src="/Projeto/Frontend/js/config.js"></script>

    <!-- Web API Store -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/devextreme-aspnet-data/5.0.0/dx.aspnet.data.min.js"></script>

    <!--ESTILO REVER BEM-->
    <script src="https://cdn3.devexpress.com/jslib/24.2.6/js/localization/dx.messages.pt.js"></script>
    <script src="https://cdn3.devexpress.com/jslib/24.2.6/js/localization/dx.messages.en.js"></script>
    <script src="https://cdn3.devexpress.com/jslib/24.2.6/js/localization/dx.messages.fr.js"></script>

    <!-- Configuração DevExpress -->
    <script src="../../../devexpress/devexpress.js"></script>
    <script src="/Projeto/Frontend/js/config.js" defer></script>
    <script src="/Projeto/Frontend/js/security.js" defer></script>
    <script src="rsm_comercializacao.js" defer></script>

    <!--LAYOUT-->
    <!-- Ícones -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
    />

    <!-- Plugins e bibliotecas -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/apexcharts@3.37.1/dist/apexcharts.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/jsvectormap@1.5.3/dist/css/jsvectormap.min.css"
    />

    <!-- Estilo principal -->
    <link rel="stylesheet" href="../../../css/adminlte.css" />
  </head>

  <body class="layout-fixed sidebar-expand-lg bg-body-tertiary">
    <div class="app-wrapper">
      <div id="sidebar-container"></div>
      <div id="header-container"></div>

      <main class="app-main m-xxl-2 text-center">
        <div class="d-flex mb-3 align-items-center">
          <div name="botoesfiltro" class="mx-auto text-center small">
            <label for="anoInput" class="me-1">Ano:</label>
            <input
              type="number"
              id="anoInput"
              value="2025"
              min="2000"
              max="2100"
              class="form-control d-inline-block form-control-sm w-auto me-2"
            />
            <label for="agrupamentoInput" class="me-1">Agrupamento:</label>
            <select
              id="agrupamentoInput"
              class="form-select d-inline-block form-select-sm w-auto me-2"
            >
              <option value="mes">Mês</option>
              <option value="cliente">Cliente</option>
              <option value="quadrimestre">Quadrimestre</option>
              <option value="estacaoano">Estação Ano</option>
              <option value="estacao">Estação</option>
              <option value="tipo">Pais</option>
            </select>
            <button id="btnCarregar" class="btn btn-primary btn-sm">
              Carregar
            </button>
          </div>
        </div>

        <div
          class="d-flex flex-wrap justify-content-between align-items-start gap-3"
        >
          <div id="dataGridContainer"></div>

          <div
            style="flex: 1 1 23%; min-width: 150px"
            class="d-flex flex-column align-items-stretch"
          >
            <!-- Caixa branca só para o gráfico -->
            <div
              id="chartWrapper"
              class="p-3 rounded shadow-sm bg-white d-flex flex-column align-items-center"
              style="flex: 1 1 19%; min-width: 200px"
            >
              <div id="chart" style="width: 100%; height: 300px"></div>
            </div>

            <!-- Botões fora da caixa branca, por baixo do gráfico -->
            <div
              class="mt-3 d-flex flex-wrap justify-content-center gap-2 w-100"
            >
              <!-- <button
                id="btnSubContratosAnalise"
                class="btn btn-secundary py-3 px-4 d-flex flex-column align-items-center flex-fill"
                style="min-width: 140px"
              >
                <i class="bi bi-file-earmark-text-fill display-6 mb-1"></i>
                <span class="fw-semibold fs-6">Nao tem nada</span>
              </button> -->
              <!-- <button
                id="btnSubContratosAnoAnterior"
                class="btn btn-secundary py-3 px-4 d-flex flex-column align-items-center flex-fill"
                style="min-width: 140px"
              >
                <i class="bi bi-clipboard2-data-fill display-6 mb-1"></i>
                <span class="fw-semibold fs-6">Ano Anterior</span>
              </button> -->
            </div>
          </div>
        </div>
        <div id="popupPrint"></div>
        <!-- teste de popup -->
      </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../../../js/adminlte.js"></script>
    <script src="../../../js/layout.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- <script src="../../../js/traducoes.js"></script> -->
  </body>
</html>

<script>
  $(document).ready(function () {
    initPivotGrid(2025, "mes");

    $("#btnCarregar").on("click", function () {
      const ano = parseInt($("#anoInput").val(), 10);
      const agrupamento = $("#agrupamentoInput").val();

      initPivotGrid(ano, agrupamento);
    });
  });
</script>
